<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>Download | YoungBat</title>
    <link href="/css/style.css" rel="stylesheet">
    <style>
        fluent-card {
            width: 100%;
            height: 100%;
        }

        .product-container {
            flex-wrap: wrap;
            display: flex;
        }
    </style>

    <!-- 引入Web Component脚本 -->
    <script src="/components/fluent-sidebar.js"></script>
    <script src="https://unpkg.com/@fluentui/web-components@2.6.1/dist/web-components.min.js" type="module"></script>
    <link href="/images/logo.ico" rel="icon" type="image/x-icon">
</head>
<body>
<!-- 使用Fluent Sidebar Web Component -->
<fluent-sidebar></fluent-sidebar>

<div class="page-content">
    <h1>Download</h1>
    <div class="product-container">
        <fluent-card id="mfsc">
            <h3>MFSC(Manager For School Computer)</h3>
            <p>Manager For School Computer is a tool that helps you optimize your school computer's performance.</p>
            <fluent-button appearance="accent" data-repo="YBTsa/MFSC" onclick="window.location.href = fetchLatestFirstBrowserDownloadUrl('YBTsa/MFSC')"
                           type="button">Get
            </fluent-button>
        </fluent-card>
    </div>
</div>
<script>
    async function fetchLatestFirstBrowserDownloadUrl(repo) {
        if (!/^[\w\-.]+\/[\w\-.]+$/.test(repo)) {
            throw new Error('Invalid repo format. Use owner/repo');
        }
        const url = `https://api.github.com/repos/${repo}/releases/latest`;
        const res = await fetch(url, {headers: {'Accept': 'application/vnd.github+json'}});
        if (!res.ok) {
            throw new Error(`GitHub API returned status ${res.status}`);
        }
        const data = await res.json();
        if (!data.assets || data.assets.length === 0) {
            return '';
        }
        return data.assets[0].browser_download_url;
    }
</script>
</body>
</html>